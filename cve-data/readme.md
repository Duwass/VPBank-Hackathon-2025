# Data preprocessing

1. Follow instructions in folder `/data-preprocessing` for CVE data.

2. For CVE-KB mapping: https://github.com/cttynul/ana

# CVE-to-KB Patch Parser

This tool parses a CVE vulnerability report and automatically extracts relevant Microsoft KB patches from per-CVE patch files. It supports grouping the report by OS, Hostname, or Server IP, selects the highest CVE score entry per group, and retrieves matching KBs. If the top CVE has no associated KB file, the tool will fall back to the next highest CVE in the group.

---

## ðŸ”§ Features

- âœ… Parse CVE report from Excel
- âœ… Match patches from per-CVE KB reports
- âœ… Group by `OS`, `Hostname`, or `Server IP`
- âœ… Filter CVEs by minimum score threshold
- âœ… Automatically fallback to second-best CVE if patch file missing
- âœ… Outputs structured JSON with patch KBs and descriptions

---


| Argument      | Description                                                     |
| ------------- | --------------------------------------------------------------- |
| `--input`     | Path to the main CVE Excel file (default: `cve_input_100.xlsx`) |
| `--kb_dir`    | Folder where KB reports are stored (default: `kb_reports/`)     |
| `--group_by`  | Column to group by: `OS`, `Hostname`, or `Server IP`            |
| `--min_score` | Only consider CVEs with score >= this (e.g., 7.0)               |
| `--output`    | Path to output JSON file (default: `top_kbs_by_group.json`)     |

## Example use
```
cd ./cve-data
python3 parse_report.py \
    --input ./cve_input_100.xlsx \
    --output ./patch.json \
    --kb_dir ./kb-reports \
    --group_by "OS" \
    --min_score 7.0
```

## References
* Data source:  https://www.kaggle.com/datasets/andrewkronser/cve-common-vulnerabilities-and-exposures/data
* KB patch search: https://catalog.update.microsoft.com/Home.aspx